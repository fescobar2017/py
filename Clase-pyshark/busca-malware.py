import pyshark

INTERFAZ = 'any'
capture = pyshark.LiveCapture(interface=INTERFAZ, display_filter='dns')

malware = ['eicar.org','emol.com']

print("üîç Escuchando tr√°fico DNS...\n")


for packet in capture:
    try:
        if hasattr(packet, 'dns') and hasattr(packet.dns, 'qry_name'):
            query_name = packet.dns.qry_name.lower()            
            
            for firma in malware:
                if firma in query_name:
                    print(f"Tr√°fico Malware detectado hacia {firma} ")
                
    except AttributeError:
        pass
